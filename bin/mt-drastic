#!/bin/bash

set +u

# Some drastic things to do

function printhelp {
cat <<EOHELP

Some drastic things to do to a server

bigbang
	destroy the world and create it anew	

EOHELP
}

if [[ -z "$*" ]]; then
printhelp
exit 0
fi

ACTION=$1; shift

case "$ACTION" in
bigbang)
	systemctl stop minetest-server
	tar czf "/root/$(date "+%F-%T").tar.gz" -C /var/games/minetest/.minetest/worlds world
	(cd /var/games/minetest-server/.minetest/worlds; rm -r world)
	systemctl start minetest-server
	;;
esac
